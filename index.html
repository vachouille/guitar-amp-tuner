<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guitar Amp Auto-Tuner</title>
    <meta name="description" content="Configurez automatiquement votre ampli selon votre guitare, micros, pÃ©dales et style musical">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial Black', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 25%, #FF8C00 50%, #D2691E 75%, #8B4513 100%);
            background-attachment: fixed;
            min-height: 100vh;
            padding: 1rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: linear-gradient(145deg, #2F1B14 0%, #4A2C20 50%, #2F1B14 100%);
            border: 4px solid #D2691E;
            border-radius: 25px;
            box-shadow: 
                0 0 30px rgba(255, 140, 0, 0.4),
                inset 0 2px 10px rgba(255, 140, 0, 0.1),
                0 8px 32px rgba(0, 0, 0, 0.3);
            padding: 2rem;
        }
        
        .header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .title {
            font-family: 'Impact', 'Arial Black', 'Helvetica Neue', Arial, sans-serif;
            color: #FFD700;
            text-shadow: 
                2px 2px 4px rgba(0, 0, 0, 0.7),
                0 0 10px rgba(255, 140, 0, 0.5);
            letter-spacing: 2px;
            font-size: 3rem;
            margin-bottom: 1rem;
            text-transform: uppercase;
        }
        
        .subtitle {
            color: #DEB887;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.6);
            font-size: 1.25rem;
            font-weight: bold;
        }
        
        .panel {
            background: linear-gradient(145deg, #FF8C00 0%, #FF7F00 50%, #FF6B00 100%);
            border: 3px solid #B8860B;
            border-radius: 15px;
            box-shadow: 
                inset 0 2px 8px rgba(255, 255, 255, 0.2),
                inset 0 -2px 8px rgba(139, 69, 19, 0.3),
                0 4px 15px rgba(0, 0, 0, 0.2);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .panel h2 {
            color: #FFF8DC;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            font-weight: 900;
        }
        
        .grid {
            display: grid;
            gap: 1.5rem;
        }
        
        .grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }
        
        .grid-5 {
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            color: #FFF8DC;
            font-weight: bold;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        select, input[type="text"] {
            background: linear-gradient(145deg, #FFF8DC 0%, #F5DEB3 100%);
            border: 2px solid #8B4513;
            border-radius: 8px;
            color: #2F1B14;
            padding: 0.75rem;
            font-weight: bold;
            box-shadow: inset 0 1px 3px rgba(139, 69, 19, 0.2);
        }
        
        select:focus, input[type="text"]:focus {
            border-color: #FF8C00;
            outline: none;
            box-shadow: 
                inset 0 1px 3px rgba(139, 69, 19, 0.2),
                0 0 8px rgba(255, 140, 0, 0.4);
        }
        
        .pedal-button {
            background: linear-gradient(145deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
            border: 2px solid #D2691E;
            border-radius: 8px;
            color: #FFF8DC;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
            box-shadow: 
                inset 0 1px 3px rgba(255, 140, 0, 0.2),
                0 3px 6px rgba(0, 0, 0, 0.3);
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
        }
        
        .pedal-button:hover {
            border-color: #FF8C00;
            box-shadow: 
                inset 0 1px 3px rgba(255, 140, 0, 0.3),
                0 0 10px rgba(255, 140, 0, 0.4);
        }
        
        .pedal-button.active {
            background: linear-gradient(145deg, #FF8C00 0%, #FF7F00 50%, #FF6B00 100%);
            color: #2F1B14;
            border-color: #B8860B;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.3);
            box-shadow: 
                inset 0 2px 4px rgba(255, 255, 255, 0.2),
                0 0 15px rgba(255, 140, 0, 0.6);
        }
        
        .cream-panel {
            background: linear-gradient(145deg, #FFF8DC 0%, #F5DEB3 50%, #DEB887 100%);
            border: 2px solid #D2691E;
            border-radius: 12px;
            box-shadow: 
                inset 0 1px 4px rgba(255, 255, 255, 0.6),
                inset 0 -1px 4px rgba(139, 69, 19, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-top: 1rem;
        }
        
        .amp-control {
            margin-bottom: 1rem;
        }
        
        .control-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .control-label {
            color: #2F1B14;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .control-value {
            background: radial-gradient(circle at 30% 30%, #FFD700, #B8860B, #8B4513);
            border: 3px solid #4A2C20;
            border-radius: 50%;
            color: #2F1B14;
            font-weight: bold;
            text-shadow: 0 1px 1px rgba(255, 255, 255, 0.3);
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
        }
        
        .slider {
            appearance: none;
            width: 100%;
            height: 10px;
            background: linear-gradient(to right, #8B4513 0%, #D2691E 50%, #FF8C00 100%);
            border: 2px solid #4A2C20;
            border-radius: 6px;
            outline: none;
            cursor: pointer;
        }
        
        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 24px;
            height: 24px;
            background: radial-gradient(circle at 30% 30%, #FFD700, #B8860B, #8B4513);
            border: 3px solid #4A2C20;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: radial-gradient(circle at 30% 30%, #FFD700, #B8860B, #8B4513);
            border: 3px solid #4A2C20;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .auto-button {
            background: linear-gradient(145deg, #FF8C00 0%, #FF7F00 50%, #FF6B00 100%);
            border: 3px solid #B8860B;
            border-radius: 12px;
            color: #2F1B14;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.3);
            padding: 1rem 2rem;
            font-size: 1.25rem;
            cursor: pointer;
            width: 100%;
            margin-top: 2rem;
            transition: all 0.2s ease;
        }
        
        .auto-button:hover:not(:disabled) {
            background: linear-gradient(145deg, #FFB84D 0%, #FF9500 50%, #FF8C00 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .auto-button:disabled {
            background: linear-gradient(145deg, #A0522D 0%, #8B4513 50%, #654321 100%);
            color: #DEB887;
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .signal-chain {
            background: linear-gradient(145deg, #FFF8DC 0%, #F5DEB3 100%);
            border: 2px solid #D2691E;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            color: #2F1B14;
            font-weight: bold;
            text-align: center;
        }
        
        .success-animation {
            animation: successPulse 0.5s ease-out;
        }
        
        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #2F1B14;
            color: #FFF8DC;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            font-weight: normal;
            border: 1px solid #D2691E;
        }
        
        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #2F1B14 transparent transparent transparent;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 0.95;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
                border-radius: 15px;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .panel {
                padding: 1rem;
            }
            
            .grid-3, .grid-5 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="title">ð¸ Guitar Amp Auto-Tuner ð¸</h1>
            <p class="subtitle">Configurez automatiquement votre ampli selon votre Ã©quipement et style musical</p>
        </header>

        <div class="panel">
            <h2>ð¸ SÃ©lection Guitare & Ampli</h2>
            <div class="grid grid-3">
                <div class="form-group">
                    <label for="guitar">ModÃ¨le de guitare</label>
                    <select id="guitar">
                        <option value="">Choisir une guitare...</option>
                        <option value="Fender Stratocaster">Fender Stratocaster</option>
                        <option value="Gibson Les Paul">Gibson Les Paul</option>
                        <option value="Fender Telecaster">Fender Telecaster</option>
                        <option value="Gibson SG">Gibson SG</option>
                        <option value="Fender Jaguar">Fender Jaguar</option>
                        <option value="Gibson ES-335">Gibson ES-335</option>
                        <option value="Ibanez RG">Ibanez RG</option>
                        <option value="PRS Custom 24">PRS Custom 24</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="pickups">Type de micros</label>
                    <select id="pickups">
                        <option value="">Choisir des micros...</option>
                        <option value="Simple bobinage">Simple bobinage</option>
                        <option value="Humbucker">Humbucker</option>
                        <option value="P90">P90</option>
                        <option value="Active (EMG)">Active (EMG)</option>
                        <option value="PAF vintage">PAF vintage</option>
                        <option value="Hot rails">Hot rails</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="amp">ModÃ¨le d'ampli</label>
                    <select id="amp">
                        <option value="">Choisir un ampli...</option>
                        <option value="Fender Twin Reverb">Fender Twin Reverb</option>
                        <option value="Marshall JCM800">Marshall JCM800</option>
                        <option value="Vox AC30">Vox AC30</option>
                        <option value="Mesa Boogie Dual Rectifier">Mesa Boogie Dual Rectifier</option>
                        <option value="Orange Rockerverb">Orange Rockerverb</option>
                        <option value="Blackstar St James Combo 212 6L6">Blackstar St James Combo 212 6L6</option>
                        <option value="Blackstar HT-1R">Blackstar HT-1R</option>
                        <option value="Blackstar HT-1R MkII">Blackstar HT-1R MkII</option>
                        <option value="Peavey 5150">Peavey 5150</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="panel">
            <h2>â¡ Configuration des PÃ©dales</h2>
            <div class="grid grid-5" id="pedals-grid">
                <button class="pedal-button" data-pedal="Overdrive">Overdrive</button>
                <button class="pedal-button" data-pedal="Distortion">Distortion</button>
                <button class="pedal-button" data-pedal="Delay">Delay</button>
                <button class="pedal-button" data-pedal="Reverb">Reverb</button>
                <button class="pedal-button" data-pedal="Chorus">Chorus</button>
                <button class="pedal-button" data-pedal="Phaser">Phaser</button>
                <button class="pedal-button" data-pedal="Wah">Wah</button>
                <button class="pedal-button" data-pedal="Compresseur">Compresseur</button>
                <button class="pedal-button" data-pedal="Fuzz">Fuzz</button>
                <button class="pedal-button" data-pedal="Noise Gate">Noise Gate</button>
            </div>
            <div id="signal-chain" class="signal-chain" style="display: none;">
                <p id="chain-text">ChaÃ®ne de signal: Guitare â Ampli</p>
            </div>
            
            <!-- Configuration des pÃ©dales -->
            <div id="pedal-configs" style="display: none; margin-top: 2rem;">
                <h3 style="color: #FFF8DC; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); font-size: 1.25rem; margin-bottom: 1rem; text-transform: uppercase; font-weight: 900;">ðï¸ RÃ©glages des Effets</h3>
                <div id="pedal-controls-container"></div>
            </div>
        </div>

        <div class="panel">
            <h2>ðµ Style Musical & Artiste</h2>
            <div class="grid grid-3">
                <div class="form-group">
                    <label for="style">Style musical</label>
                    <select id="style">
                        <option value="">Choisir un style...</option>
                        <option value="Rock classique">Rock classique</option>
                        <option value="Blues">Blues</option>
                        <option value="Jazz">Jazz</option>
                        <option value="Metal">Metal</option>
                        <option value="Punk">Punk</option>
                        <option value="Country">Country</option>
                        <option value="Funk">Funk</option>
                        <option value="Grunge">Grunge</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="artist">Artiste de rÃ©fÃ©rence</label>
                    <select id="artist">
                        <option value="">Choisir un artiste...</option>
                        <option value="Jimi Hendrix">Jimi Hendrix</option>
                        <option value="Eric Clapton">Eric Clapton</option>
                        <option value="Jimmy Page">Jimmy Page</option>
                        <option value="David Gilmour">David Gilmour</option>
                        <option value="Slash">Slash</option>
                        <option value="Eddie Van Halen">Eddie Van Halen</option>
                        <option value="Stevie Ray Vaughan">Stevie Ray Vaughan</option>
                        <option value="B.B. King">B.B. King</option>
                        <option value="custom">âï¸ Autre artiste</option>
                    </select>
                </div>
                <div class="form-group" id="custom-artist-group" style="display: none;">
                    <label for="custom-artist">Nom de l'artiste</label>
                    <input type="text" id="custom-artist" placeholder="Saisir le nom...">
                </div>
            </div>
        </div>

        <div class="cream-panel">
            <h2 class="control-label" style="margin-bottom: 1.5rem;">ðï¸ RÃ©glages de l'Ampli</h2>
            <div id="amp-controls">
                <!-- Les contrÃ´les seront gÃ©nÃ©rÃ©s dynamiquement -->
            </div>
            <button class="auto-button" id="auto-tune" disabled>ð¸ RÃ©glage Automatique ð¸</button>
            <div id="preset-info" style="display: none; margin-top: 1rem; text-align: center; color: #8B4513; font-weight: bold;">
                <p id="preset-text"></p>
            </div>
        </div>

        <footer style="text-align: center; margin-top: 2rem;">
            <div class="cream-panel">
                <h3 class="title" style="font-size: 1.5rem; margin-bottom: 0.5rem;">ð¸ Guitar Amp Auto-Tuner ð¸</h3>
                <p style="color: #8B4513; font-weight: bold;">DÃ©veloppÃ© avec â¤ï¸ pour les guitaristes</p>
            </div>
        </footer>
    </div>

    <script>
        // Ãtat de l'application
        let selectedPedals = [];
        let pedalSettings = {};
        let ampSettings = {};
        let sliderListeners = new Map(); // Pour stocker les event listeners

        // Configurations des pÃ©dales
        const pedalConfigs = {
            'Overdrive': { level: 70, drive: 40, tone: 60 },
            'Distortion': { level: 65, gain: 60, tone: 55 },
            'Fuzz': { level: 60, fuzz: 70, tone: 50 },
            'Delay': { mix: 25, time: 300, feedback: 35 },
            'Reverb': { mix: 30, size: 50, tone: 60 },
            'Chorus': { mix: 40, speed: 50, depth: 45 },
            'Phaser': { mix: 50, speed: 30, depth: 60 },
            'Wah': { position: 50, sensitivity: 70 },
            'Compresseur': { level: 75, ratio: 40, attack: 30 },
            'Noise Gate': { threshold: 25, release: 50 }
        };

        // Configurations des amplis avec leurs contrÃ´les spÃ©cifiques
        const ampConfigs = {
            'Fender Twin Reverb': {
                controls: ['gain', 'treble', 'middle', 'bass', 'reverb', 'presence', 'volume'],
                settings: { gain: 25, treble: 65, middle: 50, bass: 45, reverb: 55, presence: 45, volume: 65 }
            },
            'Marshall JCM800': {
                controls: ['gain', 'treble', 'middle', 'bass', 'reverb', 'presence', 'volume'],
                settings: { gain: 70, treble: 70, middle: 60, bass: 55, reverb: 25, presence: 65, volume: 70 }
            },
            'Vox AC30': {
                controls: ['gain', 'treble', 'middle', 'bass', 'reverb', 'cut', 'volume'],
                settings: { gain: 50, treble: 60, middle: 70, bass: 45, reverb: 40, cut: 60, volume: 65 }
            },
            'Mesa Boogie Dual Rectifier': {
                controls: ['gain', 'treble', 'middle', 'bass', 'reverb', 'presence', 'volume'],
                settings: { gain: 80, treble: 65, middle: 40, bass: 70, reverb: 30, presence: 70, volume: 60 }
            },
            'Orange Rockerverb': {
                controls: ['gain', 'treble', 'middle', 'bass', 'reverb', 'presence', 'volume'],
                settings: { gain: 65, treble: 60, middle: 65, bass: 60, reverb: 45, presence: 55, volume: 65 }
            },
            'Blackstar St James Combo 212 6L6': {
                controls: ['gain', 'treble', 'middle', 'bass', 'reverb', 'volume', 'isf'],
                settings: { gain: 50, treble: 58, middle: 62, bass: 58, reverb: 45, volume: 68, isf: 50 }
            },
            'Blackstar HT-1R': {
                controls: ['gain', 'volume', 'isf', 'reverb', 'voice'],
                settings: { gain: 35, volume: 75, isf: 50, reverb: 35, voice: 1 }
            },
            'Blackstar HT-1R MkII': {
                controls: ['gain', 'volume', 'isf', 'reverb', 'voice'],
                settings: { gain: 35, volume: 75, isf: 50, reverb: 35, voice: 1 }
            },
            'Peavey 5150': {
                controls: ['gain', 'treble', 'middle', 'bass', 'reverb', 'presence', 'volume'],
                settings: { gain: 85, treble: 75, middle: 30, bass: 75, reverb: 20, presence: 80, volume: 50 }
            }
        };

        // Presets d'artistes
        const artistPresets = {
            'Jimi Hendrix': {
                pedals: ['Fuzz', 'Wah'],
                pedalSettings: {
                    'Fuzz': { level: 65, fuzz: 75, tone: 55 },
                    'Wah': { position: 50, sensitivity: 80 }
                }
            },
            'Eric Clapton': {
                pedals: ['Overdrive'],
                pedalSettings: {
                    'Overdrive': { level: 65, drive: 35, tone: 65 }
                }
            },
            'David Gilmour': {
                pedals: ['Compresseur', 'Delay', 'Reverb'],
                pedalSettings: {
                    'Compresseur': { level: 70, ratio: 35, attack: 25 },
                    'Delay': { mix: 30, time: 400, feedback: 40 },
                    'Reverb': { mix: 35, size: 60, tone: 65 }
                }
            },
            'Slash': {
                pedals: ['Wah', 'Delay'],
                pedalSettings: {
                    'Wah': { position: 50, sensitivity: 75 },
                    'Delay': { mix: 20, time: 250, feedback: 30 }
                }
            }
        };

        // RÃ©fÃ©rences DOM
        const guitarSelect = document.getElementById('guitar');
        const pickupsSelect = document.getElementById('pickups');
        const ampSelect = document.getElementById('amp');
        const styleSelect = document.getElementById('style');
        const artistSelect = document.getElementById('artist');
        const customArtistGroup = document.getElementById('custom-artist-group');
        const customArtistInput = document.getElementById('custom-artist');
        const autoTuneBtn = document.getElementById('auto-tune');
        const signalChain = document.getElementById('signal-chain');
        const chainText = document.getElementById('chain-text');
        const presetInfo = document.getElementById('preset-info');
        const presetText = document.getElementById('preset-text');

        // Fonction pour nettoyer les event listeners
        function cleanupSliderListeners() {
            sliderListeners.forEach((listener, sliderId) => {
                const slider = document.getElementById(sliderId);
                if (slider) {
                    slider.removeEventListener('input', listener);
                }
            });
            sliderListeners.clear();
        }

        // Gestion des pÃ©dales
        document.querySelectorAll('.pedal-button').forEach(button => {
            button.addEventListener('click', () => {
                const pedal = button.dataset.pedal;
                if (selectedPedals.includes(pedal)) {
                    selectedPedals = selectedPedals.filter(p => p !== pedal);
                    button.classList.remove('active');
                    delete pedalSettings[pedal];
                } else {
                    selectedPedals.push(pedal);
                    button.classList.add('active');
                    pedalSettings[pedal] = { ...pedalConfigs[pedal] };
                }
                updateSignalChain();
                updatePedalConfigs();
                checkAutoTuneAvailable();
            });
        });

        // Mise Ã  jour des contrÃ´les d'ampli selon l'ampli sÃ©lectionnÃ©
        function updateAmpControls() {
            const selectedAmp = ampSelect.value;
            const amp = selectedAmp; // Pour utiliser dans la crÃ©ation des contrÃ´les
            const ampControlsContainer = document.getElementById('amp-controls');
            
            // Nettoyer les anciens event listeners
            cleanupSliderListeners();
            
            if (!selectedAmp) {
                // RÃ©glages par dÃ©faut si aucun ampli n'est sÃ©lectionnÃ©
                ampSettings = { gain: 50, treble: 50, middle: 50, bass: 50, reverb: 30, volume: 60 };
                ampControlsContainer.innerHTML = `
                    <p style="color: #8B4513; text-align: center; font-style: italic;">
                        Veuillez sÃ©lectionner un ampli pour afficher les contrÃ´les
                    </p>
                `;
                return;
            }

            if (!ampConfigs[selectedAmp]) {
                return;
            }

            const config = ampConfigs[selectedAmp];
            ampSettings = { ...config.settings };
            
            // Effacer les contrÃ´les existants
            ampControlsContainer.innerHTML = '';
            
            // CrÃ©er les nouveaux contrÃ´les
            config.controls.forEach(param => {
                const value = ampSettings[param] || 50;
                const displayName = getControlDisplayName(param);
                
                const controlDiv = document.createElement('div');
                controlDiv.className = 'amp-control';
                
                // Gestion spÃ©ciale pour le contrÃ´le Voice
                if (param === 'voice') {
                    const displayValue = value === 0 ? 'Clean' : 'OD';
                    controlDiv.innerHTML = `
                        <div class="control-header">
                            <label class="control-label">${displayName}</label>
                            <div class="control-value" id="${param}-value">${displayValue}</div>
                        </div>
                        <input type="range" class="slider" id="${param}" min="0" max="1" value="${value}">
                    `;
                } else if (param === 'isf' && amp.includes('Blackstar')) {
                    // ISF avec tooltip pour tous les amplis Blackstar
                    controlDiv.innerHTML = `
                        <div class="control-header">
                            <label class="control-label tooltip">
                                ${displayName}
                                <span class="tooltiptext">ISF (Infinite Shape Feature) : 0 = Son britannique (mÃ©diums prononcÃ©s), 100 = Son amÃ©ricain (mÃ©diums creusÃ©s)</span>
                            </label>
                            <div class="control-value" id="${param}-value">${value}</div>
                        </div>
                        <input type="range" class="slider" id="${param}" min="0" max="100" value="${value}">
                    `;
                } else {
                    controlDiv.innerHTML = `
                        <div class="control-header">
                            <label class="control-label">${displayName}</label>
                            <div class="control-value" id="${param}-value">${value}</div>
                        </div>
                        <input type="range" class="slider" id="${param}" min="0" max="100" value="${value}">
                    `;
                }
                ampControlsContainer.appendChild(controlDiv);
                
                // CrÃ©er la fonction d'event listener
                const sliderListener = (event) => {
                    const newValue = parseInt(event.target.value);
                    ampSettings[param] = newValue;
                    const valueDisplay = document.getElementById(param + '-value');
                    if (param === 'voice') {
                        // Pour le contrÃ´le Voice, afficher "Clean" ou "OD"
                        valueDisplay.textContent = newValue === 0 ? 'Clean' : 'OD';
                    } else {
                        valueDisplay.textContent = newValue;
                    }
                };
                
                // Ajouter l'event listener et le stocker
                const slider = document.getElementById(param);
                slider.addEventListener('input', sliderListener);
                sliderListeners.set(param, sliderListener);
            });
        }

        // Fonction pour obtenir le nom d'affichage d'un contrÃ´le
        function getControlDisplayName(param) {
            const displayNames = {
                'gain': 'Gain',
                'treble': 'Aigus',
                'middle': 'MÃ©diums',
                'bass': 'Basses',
                'reverb': 'Reverb',
                'presence': 'PrÃ©sence',
                'volume': 'Volume',
                'cut': 'Cut',
                'tone': 'TonalitÃ©',
                'isa': 'ISF',
                'isf': 'ISF',
                'eq': 'EQ',
                'voice': 'Voice'
            };
            return displayNames[param] || param.charAt(0).toUpperCase() + param.slice(1);
        }

        // Mise Ã  jour de la configuration des pÃ©dales
        function updatePedalConfigs() {
            const container = document.getElementById('pedal-controls-container');
            const pedalConfigsDiv = document.getElementById('pedal-configs');
            
            if (selectedPedals.length === 0) {
                pedalConfigsDiv.style.display = 'none';
                return;
            }
            
            pedalConfigsDiv.style.display = 'block';
            container.innerHTML = '';
            
            selectedPedals.forEach(pedal => {
                const settings = pedalSettings[pedal];
                if (!settings) return;
                
                const pedalDiv = document.createElement('div');
                pedalDiv.className = 'cream-panel';
                pedalDiv.style.marginBottom = '1rem';
                
                let controlsHTML = `
                    <h4 style="color: #2F1B14; font-weight: bold; margin-bottom: 1rem; text-transform: uppercase;">
                        ð¸ ${pedal}
                    </h4>
                    <div class="grid grid-3">
                `;
                
                Object.keys(settings).forEach(param => {
                    const value = settings[param];
                    const displayName = getPedalParamDisplayName(param);
                    const isTime = param === 'time';
                    const maxValue = isTime ? 1000 : 100;
                    const displayValue = isTime ? `${value}ms` : value;
                    
                    controlsHTML += `
                        <div class="form-group">
                            <div class="control-header">
                                <label class="control-label">${displayName}</label>
                                <div class="control-value" id="${pedal}-${param}-value">${displayValue}</div>
                            </div>
                            <input type="range" class="slider" 
                                   id="${pedal}-${param}" 
                                   min="${isTime ? 50 : 0}" 
                                   max="${maxValue}" 
                                   step="${isTime ? 10 : 1}"
                                   value="${value}">
                        </div>
                    `;
                });
                
                controlsHTML += '</div>';
                pedalDiv.innerHTML = controlsHTML;
                container.appendChild(pedalDiv);
                
                // Ajouter les event listeners pour les sliders de cette pÃ©dale
                Object.keys(settings).forEach(param => {
                    const slider = document.getElementById(`${pedal}-${param}`);
                    const valueDisplay = document.getElementById(`${pedal}-${param}-value`);
                    
                    slider.addEventListener('input', () => {
                        const newValue = parseInt(slider.value);
                        pedalSettings[pedal][param] = newValue;
                        const isTime = param === 'time';
                        const displayValue = isTime ? `${newValue}ms` : newValue;
                        valueDisplay.textContent = displayValue;
                    });
                });
            });
        }

        // Fonction pour obtenir le nom d'affichage d'un paramÃ¨tre de pÃ©dale
        function getPedalParamDisplayName(param) {
            const displayNames = {
                'level': 'Niveau',
                'drive': 'Drive',
                'gain': 'Gain',
                'tone': 'TonalitÃ©',
                'fuzz': 'Fuzz',
                'mix': 'Mix',
                'time': 'Temps',
                'feedback': 'Feedback',
                'size': 'Taille',
                'speed': 'Vitesse',
                'depth': 'Profondeur',
                'position': 'Position',
                'sensitivity': 'SensibilitÃ©',
                'ratio': 'Ratio',
                'attack': 'Attaque',
                'threshold': 'Seuil',
                'release': 'Release'
            };
            return displayNames[param] || param.charAt(0).toUpperCase() + param.slice(1);
        }

        // Gestion de l'artiste
        artistSelect.addEventListener('change', () => {
            if (artistSelect.value === 'custom') {
                customArtistGroup.style.display = 'block';
            } else {
                customArtistGroup.style.display = 'none';
                customArtistInput.value = '';
                
                // Appliquer le preset d'artiste si disponible
                if (artistPresets[artistSelect.value]) {
                    applyArtistPreset(artistSelect.value);
                }
            }
            checkAutoTuneAvailable();
        });

        // Fonction pour appliquer un preset d'artiste
        function applyArtistPreset(artist) {
            const preset = artistPresets[artist];
            if (!preset) return;
            
            // DÃ©sactiver toutes les pÃ©dales
            document.querySelectorAll('.pedal-button').forEach(button => {
                button.classList.remove('active');
            });
            selectedPedals = [];
            pedalSettings = {};
            
            // Activer les pÃ©dales du preset
            preset.pedals.forEach(pedal => {
                const button = document.querySelector(`[data-pedal="${pedal}"]`);
                if (button) {
                    button.classList.add('active');
                    selectedPedals.push(pedal);
                    pedalSettings[pedal] = { ...preset.pedalSettings[pedal] };
                }
            });
            
            updateSignalChain();
            updatePedalConfigs();
            
            // Afficher l'info du preset
            presetInfo.style.display = 'block';
            presetText.textContent = `Preset "${artist}" appliquÃ© : ${preset.pedals.join(', ')}`;
            setTimeout(() => {
                presetInfo.style.display = 'none';
            }, 3000);
        }

        // Mise Ã  jour de la chaÃ®ne de signal
        function updateSignalChain() {
            if (selectedPedals.length > 0) {
                signalChain.style.display = 'block';
                // Ordre recommandÃ© des pÃ©dales
                const pedalOrder = ['Compresseur', 'Wah', 'Overdrive', 'Distortion', 'Fuzz', 'Chorus', 'Phaser', 'Delay', 'Reverb', 'Noise Gate'];
                const orderedPedals = selectedPedals.sort((a, b) => {
                    return pedalOrder.indexOf(a) - pedalOrder.indexOf(b);
                });
                chainText.textContent = `ChaÃ®ne de signal: Guitare â ${orderedPedals.join(' â ')} â Ampli`;
            } else {
                signalChain.style.display = 'none';
            }
        }

        // VÃ©rification de la disponibilitÃ© du rÃ©glage automatique
        function checkAutoTuneAvailable() {
            const guitar = guitarSelect.value;
            const pickups = pickupsSelect.value;
            const amp = ampSelect.value;
            const style = styleSelect.value;
            const artist = artistSelect.value;
            const customArtist = customArtistInput.value.trim();

            const hasStyle = style || (artist && artist !== 'custom') || (artist === 'custom' && customArtist);
            autoTuneBtn.disabled = !(guitar && pickups && amp && hasStyle);
        }

        // RÃ©glage automatique amÃ©liorÃ©
        autoTuneBtn.addEventListener('click', () => {
            const guitar = guitarSelect.value;
            const pickups = pickupsSelect.value;
            const amp = ampSelect.value;
            const style = styleSelect.value;

            if (!amp || !ampConfigs[amp]) return;

            // Animation de chargement
            autoTuneBtn.classList.add('loading');
            autoTuneBtn.textContent = 'â³ Configuration en cours...';

            setTimeout(() => {
                // Commencer avec les rÃ©glages de base de l'ampli
                let newSettings = { ...ampConfigs[amp].settings };

                // Ajustements selon la guitare et les micros
                if (guitar.includes('Stratocaster') && pickups === 'Simple bobinage') {
                    if (newSettings.treble !== undefined) newSettings.treble = Math.min(newSettings.treble + 5, 100);
                    if (newSettings.tone !== undefined) newSettings.tone = Math.min(newSettings.tone + 8, 100);
                    if (newSettings.eq !== undefined) newSettings.eq = Math.min(newSettings.eq + 10, 100);
                    if (newSettings.isf !== undefined) newSettings.isf = Math.min(newSettings.isf + 15, 100); // Plus amÃ©ricain
                    if (newSettings.middle !== undefined) newSettings.middle = Math.max(newSettings.middle - 5, 0);
                } else if (guitar.includes('Les Paul') && pickups === 'Humbucker') {
                    if (newSettings.middle !== undefined) newSettings.middle = Math.min(newSettings.middle + 10, 100);
                    if (newSettings.tone !== undefined) newSettings.tone = Math.max(newSettings.tone - 5, 0);
                    if (newSettings.eq !== undefined) newSettings.eq = Math.max(newSettings.eq - 10, 0);
                    if (newSettings.isf !== undefined) newSettings.isf = Math.max(newSettings.isf - 15, 0); // Plus britannique
                    if (newSettings.bass !== undefined) newSettings.bass = Math.min(newSettings.bass + 10, 100);
                } else if (pickups === 'P90') {
                    if (newSettings.middle !== undefined) newSettings.middle = Math.min(newSettings.middle + 5, 100);
                    if (newSettings.tone !== undefined) newSettings.tone = Math.min(newSettings.tone + 3, 100);
                    if (newSettings.eq !== undefined) newSettings.eq = Math.min(newSettings.eq + 5, 100);
                    if (newSettings.isf !== undefined) newSettings.isf = 40; // Position intermÃ©diaire
                    if (newSettings.gain !== undefined) newSettings.gain = Math.min(newSettings.gain + 10, 100);
                } else if (pickups === 'Active (EMG)') {
                    if (newSettings.gain !== undefined) newSettings.gain = Math.max(newSettings.gain - 5, 0);
                    if (newSettings.presence !== undefined) newSettings.presence = Math.min(newSettings.presence + 10, 100);
                    if (newSettings.tone !== undefined) newSettings.tone = Math.min(newSettings.tone + 5, 100);
                    if (newSettings.eq !== undefined) newSettings.eq = Math.min(newSettings.eq + 5, 100);
                    if (newSettings.isf !== undefined) newSettings.isf = Math.min(newSettings.isf + 20, 100); // Plus amÃ©ricain
                }

                // Ajustements selon le style musical
                switch (style) {
                    case 'Blues':
                        if (newSettings.gain !== undefined) newSettings.gain = Math.max(newSettings.gain - 10, 0);
                        if (newSettings.reverb !== undefined) newSettings.reverb = Math.min(newSettings.reverb + 15, 100);
                        if (newSettings.tone !== undefined) newSettings.tone = Math.max(newSettings.tone - 5, 0);
                        if (newSettings.eq !== undefined) newSettings.eq = Math.max(newSettings.eq - 5, 0);
                        if (newSettings.isf !== undefined) newSettings.isf = 30; // Son plus britannique pour le blues
                        if (newSettings.voice !== undefined) newSettings.voice = 1; // OD pour le blues
                        break;
                    case 'Metal':
                        if (newSettings.gain !== undefined) newSettings.gain = Math.min(newSettings.gain + 15, 100);
                        if (newSettings.middle !== undefined) newSettings.middle = Math.max(newSettings.middle - 20, 0);
                        if (newSettings.tone !== undefined) newSettings.tone = Math.min(newSettings.tone + 10, 100);
                        if (newSettings.eq !== undefined) newSettings.eq = Math.min(newSettings.eq + 15, 100);
                        if (newSettings.isf !== undefined) newSettings.isf = 75; // Son plus amÃ©ricain pour le metal
                        if (newSettings.presence !== undefined) newSettings.presence = Math.min(newSettings.presence + 10, 100);
                        if (newSettings.voice !== undefined) newSettings.voice = 1; // OD pour le metal
                        break;
                    case 'Jazz':
                        if (newSettings.gain !== undefined) newSettings.gain = Math.max(newSettings.gain - 30, 0);
                        if (newSettings.middle !== undefined) newSettings.middle = Math.min(newSettings.middle + 15, 100);
                        if (newSettings.tone !== undefined) newSettings.tone = Math.max(newSettings.tone - 10, 0);
                        if (newSettings.eq !== undefined) newSettings.eq = Math.max(newSettings.eq - 10, 0);
                        if (newSettings.isf !== undefined) newSettings.isf = 20; // Son trÃ¨s britannique pour le jazz
                        if (newSettings.reverb !== undefined) newSettings.reverb = Math.min(newSettings.reverb + 10, 100);
                        if (newSettings.voice !== undefined) newSettings.voice = 0; // Clean pour le jazz
                        break;
                    case 'Country':
                        if (newSettings.gain !== undefined) newSettings.gain = Math.max(newSettings.gain - 25, 0);
                        if (newSettings.treble !== undefined) newSettings.treble = Math.min(newSettings.treble + 10, 100);
                        if (newSettings.tone !== undefined) newSettings.tone = Math.min(newSettings.tone + 15, 100);
                        if (newSettings.eq !== undefined) newSettings.eq = Math.min(newSettings.eq + 20, 100);
                        if (newSettings.isf !== undefined) newSettings.isf = 80; // Son amÃ©ricain pour la country
                        if (newSettings.reverb !== undefined) newSettings.reverb = Math.min(newSettings.reverb + 20, 100);
                        if (newSettings.voice !== undefined) newSettings.voice = 0; // Clean pour la country
                        break;
                    case 'Rock classique':
                        if (newSettings.gain !== undefined) newSettings.gain = Math.min(newSettings.gain + 5, 100);
                        if (newSettings.middle !== undefined) newSettings.middle = Math.min(newSettings.middle + 5, 100);
                        if (newSettings.eq !== undefined) newSettings.eq = 60; // Position neutre pour le rock
                        if (newSettings.isf !== undefined) newSettings.isf = 50; // Position neutre
                        if (newSettings.voice !== undefined) newSettings.voice = 1; // OD pour le rock
                        break;
                    case 'Punk':
                        if (newSettings.gain !== undefined) newSettings.gain = Math.min(newSettings.gain + 20, 100);
                        if (newSettings.treble !== undefined) newSettings.treble = Math.min(newSettings.treble + 15, 100);
                        if (newSettings.middle !== undefined) newSettings.middle = Math.max(newSettings.middle - 10, 0);
                        if (newSettings.eq !== undefined) newSettings.eq = Math.min(newSettings.eq + 10, 100);
                        if (newSettings.isf !== undefined) newSettings.isf = 25; // Son britannique agressif
                        if (newSettings.voice !== undefined) newSettings.voice = 1; // OD pour le punk
                        break;
                    case 'Funk':
                        if (newSettings.gain !== undefined) newSettings.gain = Math.max(newSettings.gain - 20, 0);
                        if (newSettings.treble !== undefined) newSettings.treble = Math.min(newSettings.treble + 10, 100);
                        if (newSettings.middle !== undefined) newSettings.middle = Math.max(newSettings.middle - 10, 0);
                        if (newSettings.eq !== undefined) newSettings.eq = Math.min(newSettings.eq + 10, 100);
                        if (newSettings.isf !== undefined) newSettings.isf = 70; // Son amÃ©ricain clair
                        if (newSettings.voice !== undefined) newSettings.voice = 0; // Clean pour le funk
                        break;
                    case 'Grunge':
                        if (newSettings.gain !== undefined) newSettings.gain = Math.min(newSettings.gain + 25, 100);
                        if (newSettings.middle !== undefined) newSettings.middle = Math.min(newSettings.middle + 10, 100);
                        if (newSettings.bass !== undefined) newSettings.bass = Math.min(newSettings.bass + 15, 100);
                        if (newSettings.eq !== undefined) newSettings.eq = Math.max(newSettings.eq - 15, 0);
                        if (newSettings.isf !== undefined) newSettings.isf = 35; // Son britannique sombre
                        if (newSettings.voice !== undefined) newSettings.voice = 1; // OD pour le grunge
                        break;
                }

                // Ajustements selon les pÃ©dales actives
                selectedPedals.forEach(pedal => {
                    switch (pedal) {
                        case 'Overdrive':
                            const overdriveSettings = pedalSettings['Overdrive'];
                            if (overdriveSettings && newSettings.gain !== undefined) {
                                const driveLevel = overdriveSettings.drive || 40;
                                const gainReduction = Math.floor(driveLevel / 3);
                                newSettings.gain = Math.max(newSettings.gain - gainReduction, 0);
                            }
                            break;
                        case 'Distortion':
                            const distortionSettings = pedalSettings['Distortion'];
                            if (distortionSettings && newSettings.gain !== undefined) {
                                const gainLevel = distortionSettings.gain || 60;
                                const gainReduction = Math.floor(gainLevel / 2);
                                newSettings.gain = Math.max(newSettings.gain - gainReduction, 0);
                            }
                            break;
                        case 'Fuzz':
                            if (newSettings.gain !== undefined) {
                                newSettings.gain = Math.max(newSettings.gain - 30, 0);
                            }
                            if (newSettings.tone !== undefined) {
                                newSettings.tone = Math.max(newSettings.tone - 10, 0);
                            }
                            break;
                        case 'Delay':
                            const delaySettings = pedalSettings['Delay'];
                            if (delaySettings && newSettings.reverb !== undefined) {
                                const mixLevel = delaySettings.mix || 25;
                                const reverbReduction = Math.floor(mixLevel / 2);
                                newSettings.reverb = Math.max(newSettings.reverb - reverbReduction, 0);
                            }
                            break;
                        case 'Reverb':
                            const reverbPedalSettings = pedalSettings['Reverb'];
                            if (reverbPedalSettings && newSettings.reverb !== undefined) {
                                const mixLevel = reverbPedalSettings.mix || 30;
                                const reverbReduction = Math.floor(mixLevel / 2);
                                newSettings.reverb = Math.max(newSettings.reverb - reverbReduction, 0);
                            }
                            break;
                        case 'Compresseur':
                            const compSettings = pedalSettings['Compresseur'];
                            if (compSettings && newSettings.gain !== undefined) {
                                const ratio = compSettings.ratio || 40;
                                const gainReduction = Math.floor(ratio / 8);
                                newSettings.gain = Math.max(newSettings.gain - gainReduction, 0);
                            }
                            break;
                    }
                });

                // Application des nouveaux rÃ©glages avec animation
                Object.keys(newSettings).forEach((param, index) => {
                    setTimeout(() => {
                        const slider = document.getElementById(param);
                        const valueDisplay = document.getElementById(param + '-value');
                        if (slider && valueDisplay) {
                            // Animation smooth du slider
                            const startValue = parseInt(slider.value);
                            const endValue = newSettings[param];
                            const duration = 500; // ms
                            const steps = 20;
                            const stepTime = duration / steps;
                            let currentStep = 0;

                            const animateSlider = () => {
                                if (currentStep <= steps) {
                                    const progress = currentStep / steps;
                                    const currentValue = Math.round(startValue + (endValue - startValue) * progress);
                                    slider.value = currentValue;
                                    if (param === 'voice') {
                                        valueDisplay.textContent = currentValue === 0 ? 'Clean' : 'OD';
                                    } else {
                                        valueDisplay.textContent = currentValue;
                                    }
                                    ampSettings[param] = currentValue;
                                    currentStep++;
                                    setTimeout(animateSlider, stepTime);
                                }
                            };
                            animateSlider();
                        }
                    }, index * 100);
                });

                // Animation de confirmation
                setTimeout(() => {
                    autoTuneBtn.classList.remove('loading');
                    autoTuneBtn.classList.add('success-animation');
                    autoTuneBtn.style.background = 'linear-gradient(145deg, #32CD32 0%, #228B22 50%, #006400 100%)';
                    autoTuneBtn.textContent = 'â RÃ©glage AppliquÃ© !';
                    
                    setTimeout(() => {
                        autoTuneBtn.classList.remove('success-animation');
                        autoTuneBtn.style.background = '';
                        autoTuneBtn.textContent = 'ð¸ RÃ©glage Automatique ð¸';
                    }, 2000);
                }, Object.keys(newSettings).length * 100 + 500);
            }, 500);
        });

        // Event listeners pour la validation
        [guitarSelect, pickupsSelect, styleSelect, artistSelect, customArtistInput].forEach(element => {
            element.addEventListener('change', checkAutoTuneAvailable);
            element.addEventListener('input', checkAutoTuneAvailable);
        });

        // Gestion du changement d'ampli
        ampSelect.addEventListener('change', () => {
            updateAmpControls();
            checkAutoTuneAvailable();
        });

        // Initialisation
        updateAmpControls();
        checkAutoTuneAvailable();
    </script>
</body>
</html>
